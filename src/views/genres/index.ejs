
<div class="flex flex-col gap-4 relative">
  <h2 class="text-2xl font-bold text-gray-700">Quản lý tác giả</h2>
  <%- include('../errorMessageWithQuery') %> <%-
  include('../successMessageWithQuery') %>
  <a href="/genre/add" class="text-white hover:underline bg-green-600 w-52 text-center p-2 rounded">Thêm thể loại</a>
  <form id="search-form" class="flex flex-col gap-4">
    <div class="flex flex-col sm:flex-row items-center flex-wrap justify-center gap-2">
      <input
        name="q"
        type="text"
        placeholder="Tìm kiếm thể loại"
        value="<%= query.q || '' %>"
        class="flex-1 border rounded px-3 py-2 max-w-md w-full"
      />
      <select
        class="flex-1 border rounded px-3 py-2 max-w-md w-full"
        name="sort"
        id="sort"
      >
        <option value="">--Sắp xếp thể loại--</option>
        <option value="name-asc" <%= query.sort === 'name-asc' ? 'selected' : '' %>>Sắp xếp theo tên A-Z</option>
        <option value="name-desc" <%= query.sort === 'name-desc' ? 'selected' : '' %>>Sắp xếp theo tên Z-A</option>
        <option value="createdAt-desc" <%= query.sort === 'createdAt-desc' ? 'selected' : '' %>>Mới nhất</option>
        <option value="createdAt-asc" <%= query.sort === 'createdAt-asc' ? 'selected' : '' %>>Cũ nhất</option>
      </select>
      <button class="bg-blue-600 w-full sm:w-25 text-white px-4 py-2 rounded">
        Tìm kiếm
      </button>
    </div>
  </form>
  <div class="overflow-x-auto relative">
    <table
      class="min-w-full bg-white border rounded border-gray-200 relative z-0"
    >
      <thead class="sticky top-0 bg-gray-50 z-10">
        <tr>
          <th
            class="px-6 py-3 border-b border-gray-200 text-left text-sm font-semibold text-gray-600"
          >
            #
          </th>
          <th
            class="px-6 py-3 border-b border-gray-200 text-left text-sm font-semibold text-gray-600"
          >
            Tên tác giả
          </th>
          <th
            class="px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-sm font-semibold text-gray-600"
          >
            Hành động
          </th>
        </tr>
      </thead>
      <tbody class="relative z-0">
        <% genres.forEach((genre, index) => { %>
        <tr class="hover:bg-gray-100 relative">
          <td class="px-6 py-4 border-b border-gray-200 text-sm text-gray-700">
            <%= ++index %>
          </td>
          <td class="px-6 py-4 border-b border-gray-200 text-sm text-gray-700">
            <%= genre.name %>
          </td>
          <td
            class="px-6 py-4 border-b border-gray-200 text-sm text-gray-700 relative"
          >
           <div class="flex flex-col sm:flex-row flex-wrap gap-1">
              <a
                href="/genre/edit/<%= genre.id %>"
                class="text-center p-2 bg-blue-100 text-blue-600 hover:underline block mb-1 hover:bg-blue-200 rounded px-1"
                >Sửa</a
              >
              <a
                href="/genre/delete/<%= genre.id %>"
                class="text-center p-2 bg-red-100 text-red-600 hover:underline block mb-1 hover:bg-red-200 rounded px-1"
                >Xóa</a
              >
             
              
              <a
                href="/genre/detail/<%= genre.id %>"
                class="text-center p-2 bg-green-100 text-green-600 hover:underline block mb-1 hover:bg-green-200 rounded px-1"
                >Chi tiết</a
              >
            </div>
          </td>
        </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
  <%- include('../partials/pagination', { totals, page, query }) %>

  
</div>
  <script>
    function toggleMenu(id) {
      document.querySelectorAll('[id^="menu-"]').forEach((m) => {
        if (m.id !== "menu-" + id) m.classList.add("hidden");
      }); // Hiện / ẩn menu được chọn
      const menu = document.getElementById("menu-" + id);
      menu.classList.toggle("hidden");
    }
    document.addEventListener("click", (e) => {
      if (!e.target.closest("td")) {
        document
          .querySelectorAll('[id^="menu-"]')
          .forEach((m) => m.classList.add("hidden"));
      }
    });
  </script>

<script src="js/dispatchSelectForm.js"></script>
<script>
  dispatchSelectForm('#search-form', '#sort');
</script>
